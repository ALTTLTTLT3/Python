"""This is the review sub feature in the customer feature.
customer will be able to write reviews about toys here and it will get
saved into the database.customer are also able to view all the reviews that is already stored in the database"""

# Student Name-Tahmida Lotif Tarin
# Id-001125724


from tkinter import *

import sqlite3

root = Tk()
root.title('Review Window')

root.geometry("400x300")
root.iconphoto(False,
               PhotoImage(file='toys.png'))

# Databases

# Create a database or connect to one
conn = sqlite3.connect('db.db')

# Create cursor
c = conn.cursor()


# Create post review Function For database
def post_review():
    conn = sqlite3.connect('db.db')
    c = conn.cursor()

    # Insert Into Table
    c.execute("INSERT INTO reviews VALUES (:ToyId, :ToyName, :UserName, :Review)",
              {
                  'ToyId' : ToyId.get(),
                  'ToyName': ToyName.get(),
                  'UserName': UserName.get(),
                  'Review': Review.get(),

              })

    conn.commit()
    conn.close()

    # Clear The Text Boxes
    ToyId.delete(0, END)
    ToyName.delete(0, END)
    UserName.delete(0, END)
    Review.delete(0, END)


# Create see all review Function
def see_all_review():
    import sqlite3
    conn = sqlite3.connect('db.db')
    c = conn.cursor()

    # see all existing review from the database
    c.execute("SELECT *, oid FROM reviews")
    reviews = c.fetchall()

    # Loop Through Results
    nem = 9
    for review in reviews:
        tid = Label(root, text=review[0])
        tid.grid(row=nem, column=0, padx=10, pady=10)
        tname = Label(root, text=review[1])
        tname.grid(row=nem, column=1, padx=10, pady=10)
        uname = Label(root, text=review[2])
        uname.grid(row=nem, column=2, padx=10, pady=10)
        r = Label(root, text=review[3])
        r.grid(row=nem, column=3, padx=10, pady=10)

        nem = nem + 1

    conn.commit()
    conn.close()


# Create Text Boxes
ToyId = Entry(root, width=30)
ToyId.grid(row=0, column=1)
ToyName = Entry(root, width=30)
ToyName.grid(row=1, column=1, padx=20, pady=(10, 0))
UserName = Entry(root, width=30)
UserName.grid(row=2, column=1)
Review = Entry(root, width=30)
Review.grid(row=3, column=1)


# Create Text Box Labels
toyid_label = Label(root, text="Toy Id")
toyid_label.grid(row=0, column=0)
toyname_label = Label(root, text="Toy Name")
toyname_label.grid(row=1, column=0, pady=(10, 0))
username_label = Label(root, text="Username")
username_label.grid(row=2, column=0)
review_label = Label(root, text="Review")
review_label.grid(row=3, column=0)



# Create post review Button
post_review_btn = Button(root, text="Post Review", command=post_review)
post_review_btn.grid(row=6, column=0, columnspan=2, pady=10, padx=10, ipadx=100)

# Create a show all review Button
show_all_review_btn = Button(root, text="Show All Reviews", command=see_all_review)
show_all_review_btn.grid(row=7, column=0, columnspan=2, pady=10, padx=10, ipadx=137)

tid_lbl = Label(root, text='Toy Id').grid(row=8, column=0, padx=10, pady=10)
tname_lbl = Label(root, text='Toy Name').grid(row=8, column=1, padx=10, pady=10)
uname_lbl = Label(root, text='User Name').grid(row=8, column=2, padx=10, pady=10)
r_lbl = Label(root, text='Review').grid(row=8, column=3, padx=10, pady=10)

conn.commit()
conn.close()
root.mainloop()
